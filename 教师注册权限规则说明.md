# 教师注册权限规则说明

## 📋 规则概述

**生效日期**: 2026年3月1日  
**规则内容**: 教师账号用户名必须以"Ujs"开头

---

## 🎯 规则详情

### 适用范围
- **仅适用于**: 教师角色（role = 'teacher'）
- **不适用于**: 学生角色（role = 'student'）

### 验证规则
```javascript
// 教师用户名必须以"Ujs"开头（区分大小写）
if (role === 'teacher' && !username.startsWith('Ujs')) {
    // 注册失败
    return '教师账号用户名必须以"Ujs"开头';
}
```

### 有效示例
✅ **以下用户名可以注册为教师**:
- `Ujs001`
- `UjsTeacher`
- `Ujs123`
- `UjsAdmin`
- `UjsMath`
- `Ujs` (最短有效)

### 无效示例
❌ **以下用户名不能注册为教师**:
- `teacher001` - 不以Ujs开头
- `ujs001` - 小写开头（区分大小写）
- `UJS001` - 全大写（必须是Ujs）
- `ujsTeacher` - 小写开头
- `admin` - 不以Ujs开头

---

## 💻 技术实现

### 修改的文件

#### 1. js/modules/Auth.js
在`register()`方法中添加验证逻辑：

```javascript
// Teacher registration restriction: username must start with "Ujs"
if (role === 'teacher' && !username.startsWith('Ujs')) {
    return {
        success: false,
        message: '教师账号用户名必须以"Ujs"开头'
    };
}
```

**位置**: 在用户名存在性检查之前，角色验证之后

#### 2. auth.html
添加动态提示元素：

```html
<span class="form-hint" id="usernameHint">用户名长度为3-20个字符</span>
```

#### 3. js/auth.js
添加角色选择监听器：

```javascript
// Role selection change handler - update username hint
const roleInputs = document.querySelectorAll('input[name="role"]');
const usernameHint = document.getElementById('usernameHint');

roleInputs.forEach(radio => {
    radio.addEventListener('change', (e) => {
        if (e.target.value === 'teacher') {
            usernameHint.textContent = '教师账号用户名必须以"Ujs"开头（例如：Ujs001）';
            usernameHint.style.color = '#e74c3c';
        } else {
            usernameHint.textContent = '用户名长度为3-20个字符';
            usernameHint.style.color = '';
        }
    });
});
```

---

## 🧪 测试验证

### 测试页面
创建了专门的测试页面：`test-teacher-registration.html`

### 测试用例

**Test 1: 有效的教师用户名**
- 用户名: `Ujs001`
- 角色: 教师
- 预期: ✅ 注册成功

**Test 2: 无效的教师用户名**
- 用户名: `teacher001`
- 角色: 教师
- 预期: ❌ 注册失败，提示"教师账号用户名必须以Ujs开头"

**Test 3: 学生账号无限制**
- 用户名: `student001`
- 角色: 学生
- 预期: ✅ 注册成功（学生无Ujs限制）

**Test 4: 多个有效教师用户名**
- 用户名: `UjsTeacher`, `Ujs123`, `UjsAdmin`
- 角色: 教师
- 预期: ✅ 全部注册成功

**Test 5: 边界情况**
- `Ujs` - ✅ 最短有效用户名
- `ujs001` - ❌ 小写开头
- `UJS001` - ❌ 全大写
- `ujsTeacher` - ❌ 小写开头

### 运行测试
```bash
# 在浏览器中打开
test-teacher-registration.html

# 点击"运行所有测试"按钮
# 查看测试结果
```

---

## 📱 用户体验

### 注册流程

#### 1. 选择角色
用户在注册表单中选择"教师"角色

#### 2. 动态提示
- 用户名输入框下方的提示文字自动更新
- 从"用户名长度为3-20个字符"
- 变为"教师账号用户名必须以'Ujs'开头（例如：Ujs001）"
- 提示文字变为红色，引起注意

#### 3. 输入用户名
用户输入符合规则的用户名（如：Ujs001）

#### 4. 提交注册
- 如果用户名符合规则：注册成功
- 如果用户名不符合规则：显示错误提示

### 错误提示
```
❌ 教师账号用户名必须以"Ujs"开头
```

---

## 🔒 安全考虑

### 为什么需要这个规则？

1. **身份识别**: 通过用户名前缀快速识别教师账号
2. **权限管理**: 便于管理和审计教师账号
3. **防止滥用**: 限制教师账号的随意注册
4. **组织管理**: 符合学校账号命名规范（Ujs = 江苏大学）

### 实施建议

1. **预先分配**: 建议由管理员预先创建教师账号
2. **账号审核**: 定期审核教师账号使用情况
3. **权限控制**: 教师账号拥有更高权限（编辑节点、生成教案）
4. **文档说明**: 在用户手册中明确说明此规则

---

## 📊 影响范围

### 受影响的功能
- ✅ 教师注册流程
- ✅ 用户名验证逻辑
- ✅ 注册表单UI提示

### 不受影响的功能
- ✅ 学生注册（无限制）
- ✅ 用户登录
- ✅ 已有教师账号
- ✅ 其他系统功能

---

## 🔄 后续优化建议

### 短期优化
1. 添加用户名实时验证（输入时即时反馈）
2. 提供用户名生成建议（如：Ujs + 工号）
3. 添加更详细的错误提示

### 中期优化
1. 实现管理员批量创建教师账号功能
2. 添加教师账号审核流程
3. 支持教师账号导入（CSV/Excel）

### 长期优化
1. 集成学校统一身份认证系统
2. 实现单点登录（SSO）
3. 添加多因素认证（MFA）

---

## 📞 常见问题

### Q1: 为什么必须是"Ujs"而不是"ujs"？
**A**: JavaScript的`startsWith()`方法区分大小写。"Ujs"是江苏大学的标准缩写格式。

### Q2: 学生可以使用以"Ujs"开头的用户名吗？
**A**: 可以。此规则仅限制教师角色，学生角色无此限制。

### Q3: 已有的不符合规则的教师账号怎么办？
**A**: 已有账号不受影响，此规则仅适用于新注册的教师账号。

### Q4: 可以修改这个规则吗？
**A**: 可以。在`js/modules/Auth.js`中修改验证逻辑即可。

### Q5: 如何批量创建教师账号？
**A**: 目前需要逐个注册。建议后续开发管理员批量创建功能。

---

## 📝 更新日志

### v1.0 (2026-03-01)
- ✅ 实现教师用户名"Ujs"前缀验证
- ✅ 添加动态UI提示
- ✅ 创建测试页面
- ✅ 编写完整文档

---

## 🔗 相关文件

### 核心文件
- `js/modules/Auth.js` - 认证模块（包含验证逻辑）
- `auth.html` - 注册/登录页面
- `js/auth.js` - 页面交互脚本

### 测试文件
- `test-teacher-registration.html` - 测试页面

### 文档文件
- `教师注册权限规则说明.md` - 本文档

---

## 📧 技术支持

如有问题或建议，请联系：
- 技术文档：查看本文档
- 测试验证：运行`test-teacher-registration.html`
- 代码审查：查看`js/modules/Auth.js`

---

**文档版本**: 1.0  
**最后更新**: 2026年3月1日  
**状态**: ✅ 已实施并测试

---

**规则生效！教师注册现在需要用户名以"Ujs"开头。** 🎓✨
